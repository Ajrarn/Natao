<div flex layout="column" ng-controller="EditorController as EditorCtrl">
    <div class="bandeau" ng-show="!EditorCtrl.inPrint" layout="row" layout-align="space-between center">
        <div layout="row" layput-align="start center">
            <button ng-click="appCtrl.zoomLower()" title="{{'ZOOM_OUT' | translate}}"><span class="typcn typcn-zoom-out-outline"></span></button>
            <button ng-click="appCtrl.zoomHigher()" title="{{'ZOOM_IN' | translate}}"><span class="typcn typcn-zoom-in-outline"></span></button>
        </div>
        <button class="toggle" ng-class="{off: !appCtrl.PreferencesService.preferences.showDys}" ng-click="appCtrl.toggleDys()" title="{{'DYS' | translate}}"><span class="typcn typcn-feather"></span></button>
        <div layout="row" layput-align="start center">
            <button class="toggle" ng-class="{off: !appCtrl.PreferencesService.preferences.showMenu}" ng-click="appCtrl.toggleMenu()" title="{{'MENU' | translate}}"><span class="typcn typcn-th-menu-outline"></span></button>
            <button class="toggle" ng-class="{off: !appCtrl.PreferencesService.preferences.showEditor}" ng-click="appCtrl.toggleEditor()" title="{{'EDITOR' | translate}}"><span class="typcn typcn-edit"></span></button>
            <button class="toggle" ng-class="{off: !appCtrl.PreferencesService.preferences.showVisualiser}" ng-click="appCtrl.toggleVisualiser()" title="{{'VISUALIZER' | translate}}"><span class="typcn typcn-eye-outline"></span></button>
        </div>

        <div layout="row" layput-align="start center">
            <button ng-click="EditorCtrl.print()" title="{{'PRINT' | translate}}"><span class="typcn typcn-printer"></span></button>
            <button ng-click="EditorCtrl.print()" title="{{'HELP' | translate}}"><span class="typcn typcn-compass"></span></button>
            <button ng-click="appCtrl.goSettings()" title="{{'SETTINGS' | translate}}"><span class="typcn typcn-cog-outline"></span></button>
        </div>
    </div>
    <div class="principal" flex layout="row">
        <div class="left-panel" layout="row" ng-class="{hidden: !appCtrl.PreferencesService.preferences.showMenu}" ng-show="!EditorCtrl.inPrint">
            <div class="menu" layout="column">
                <button ng-click="EditorCtrl.PrincipalTreeService.addClass()">{{'BTN_ADD_CLASS' | translate}}</button>
                <div class="treeContainer" flex>
                    <treecontrol class="tree-light"
                                 tree-model="EditorCtrl.PrincipalTreeService.principalTree.tree"
                                 options="EditorCtrl.PrincipalTreeService.treeOptions"
                                 on-selection="EditorCtrl.PrincipalTreeService.selectNode(node,selected)"
                                 selected-node="EditorCtrl.PrincipalTreeService.principalTree.selectedNode"
                                 expanded-nodes="EditorCtrl.PrincipalTreeService.principalTree.expandedNodes">
                    <span ng-switch="" on="EditorCtrl.PrincipalTreeService.isNodeOpen(node)">
                         <span ng-switch-when="close" class="typcn typcn-folder" aria-hidden="true"></span>
                         <span ng-switch-when="open" class="typcn typcn-folder-open" aria-hidden="true"></span>
                     </span>
                        {{node.name}}
                    </treecontrol>
                </div>
            </div>
            <div class="files">
                <script type="text/ng-template" id="popover">
                    <ul>
                        <li><a>Toto</a></li>
                        <li><a>Tata</a></li>
                    </ul>
                </script>

                <button ns-popover
                        ns-popover-template="popover"
                        ns-popover-trigger="click"
                        ns-popover-placement="bottom">
                    Popover
                </button>
                <div id="node">
                    <label for="nodeName" layout="column" layout-align="center center">
                        <p>{{ 'NODE_NAME' | translate }}</p>
                        <input id="nodeName" ng-model="EditorCtrl.PrincipalTreeService.principalTree.selectedNode.name"
                               ng-model-options="{ updateOn: 'default blur', debounce: {'default': 500, 'blur': 0} }" ng-change="EditorCtrl.PrincipalTreeService.save()">
                        <select ng-model="EditorCtrl.PrincipalTreeService.principalTree.selectedNode.css" ng-options="css.name as css.name for css in appCtrl.CssService.availableCss">
                        </select>
                    </label>
                    <button ng-click="EditorCtrl.PrincipalTreeService.addFolder()">{{'BTN_ADD_FOLDER' | translate}}</button>

                </div>
                <div id="files">
                    <ul>
                        <li ng-repeat="doc in EditorCtrl.PrincipalTreeService.docsMarkdown" ng-click="EditorCtrl.selectMarkdown(doc)">{{doc.title}}</li>
                    </ul>
                </div>
                <button ng-click="EditorCtrl.PrincipalTreeService.addMarkdown()">{{'BTN_ADD_MARKDOWN' | translate}}</button>
            </div>
        </div>

        <div flex layout="column" class="content" ng-class="{goright: (appCtrl.PreferencesService.preferences.showMenu && !EditorCtrl.inPrint)}">
            <div flex layout=row">
                <div class="editor" flex layout="column" ng-show="!EditorCtrl.inPrint" ng-class="{hidden: !EditorCtrl.showEditor()}">
                    <label for="title" layout="row" layout-align="start center">
                        <p>{{ 'DOC_TITLE' | translate }}</p>
                        <input id="title" type="text" ng-model="EditorCtrl.PrincipalTreeService.currentMarkdown.title" ng-change="EditorCtrl.refresh()" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 500, 'blur': 0} }">
                    </label>

                    <label for="created" layout="row" layout-align="start center">
                        <p>{{ 'DOC_CREATED' | translate }}</p>
                        <input id="created" type="date" ng-model="EditorCtrl.PrincipalTreeService.currentMarkdown.created" ng-change="EditorCtrl.refresh()" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 500, 'blur': 0} }">
                    </label>


                    <textarea flex rows="4" cols="50" ng-model="EditorCtrl.PrincipalTreeService.currentMarkdown.md" ng-change="EditorCtrl.refresh()" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 500, 'blur': 0} }">
                    </textarea>
                </div>
                <div class="visualiser" flex ng-class="[{hidden: !EditorCtrl.showVisualizer()},{inprint: EditorCtrl.inPrint}]"
                     layout="column" layout-align="start stretch">
                    <div class="haut" layout="row" layout-align="start stretch">
                        <div class="identity" layout="column" layout-align="center center">
                            <p>{{EditorCtrl.PreferencesService.preferences.name}}</p>
                            <p>{{EditorCtrl.PreferencesService.preferences.firstName}}</p>
                        </div>
                        <div class="title-zone" layout="column" layout-align="center center">
                            <h1>{{EditorCtrl.PrincipalTreeService.currentMarkdown.title}}</h1>
                            <p>{{EditorCtrl.PrincipalTreeService.currentMarkdown.created | date : 'longDate'}}</p>
                        </div>
                    </div>
                    <div class="notation"></div>
                    <div class="devoir" flex layout="row" layout-align="start stretch">
                        <div class="marge"></div>
                        <div id="rendu" markdown-to-html="EditorCtrl.PrincipalTreeService.currentMarkdown.md" flex></div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>